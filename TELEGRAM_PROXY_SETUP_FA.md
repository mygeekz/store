# راه‌اندازی تلگرام در شبکه فیلتر (Windows + V2Ray)

اگر تلگرام در شبکه شما فیلتر است و با V2Ray/V2RayNG به تلگرام دسترسی دارید، **بک‌اند Node.js** باید درخواست‌های تلگرام را از داخل همان پراکسی بفرستد.

این پروژه از پراکسی پشتیبانی می‌کند و کافی است قبل از اجرای سرور، متغیر محیطی `TG_PROXY` را تنظیم کنید.

## 1) پورت پراکسی لوکال را پیدا کنید
در کلاینت V2Ray معمولاً یکی از این‌ها فعال است:

- SOCKS5: `127.0.0.1:10808`
- HTTP: `127.0.0.1:10809`

اگر پورت‌های شما متفاوت است، همان‌ها را جایگزین کنید.

## 2) اجرای پروژه با پراکسی (Windows PowerShell)

### حالت SOCKS5 (پیشنهادی)
```powershell
$env:TG_PROXY="socks5://127.0.0.1:10808"
npm run dev
```

### حالت HTTP Proxy
```powershell
$env:TG_PROXY="http://127.0.0.1:10809"
npm run dev
```

> نکته: تنظیم env فقط برای همان پنجره PowerShell اعمال می‌شود.

## 3) تست اتصال
داخل برنامه: Settings → Telegram → «بررسی اتصال»

یا با curl:
```powershell
curl "http://localhost:3001/api/telegram/health"
```

## 4) متغیرهای جایگزین
اگر در شبکه شما پراکسی به صورت رسمی از env استفاده می‌کند، می‌توانید به جای `TG_PROXY` از این‌ها هم استفاده کنید:
- `HTTPS_PROXY`
- `HTTP_PROXY`

پروژه اولویت را به `TG_PROXY` می‌دهد.
